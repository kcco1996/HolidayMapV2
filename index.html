<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Kieran’s Holiday Destinations Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Leaflet CSS -->
  <link rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin="" />

  <style>
    html, body { height: 100%; margin: 0; }
    #map { height: 100vh; width: 100%; }

    .popup .header { display:flex; align-items:center; gap:10px; }
    .popup .header img { width:64px; height:64px; object-fit:contain; }
    .popup .title { line-height:1.3; }

    .destination-icon { background: transparent; border: 0; }
    .destination-icon img { display: block; height: 30px; width: auto; }

    /* --- Trip planner styles inside popups --- */
    .tabs {
      display: flex; gap: 6px; margin-top: 8px; margin-bottom: 8px; flex-wrap: wrap;
    }
    .tab-btn {
      border: 1px solid #ccc; background: #f6f6f6; padding: 4px 8px; border-radius: 6px;
      cursor: pointer; font-size: 13px;
    }
    .tab-btn.active { background: #e7f0ff; border-color: #8db6ff; }
    .tab-panel { display: none; }
    .tab-panel.active { display: block; }

    .row { display:flex; align-items:center; gap:8px; margin: 6px 0; }
    .row label { font-size: 13px; min-width: 130px; }
    .row input[type="number"], .row input[type="text"], .row select { padding: 4px; }

    .hint { font-size: 12px; color: #666; margin-top: 4px; }
    .save-bar { display:flex; gap:8px; margin-top:8px; }
    .btn {
      border:1px solid #bbb; background:#fff; padding:6px 10px; border-radius:6px; cursor:pointer; font-size:13px;
    }
    .btn.primary { background:#2563eb; color:#fff; border-color:#2563eb; }
    .btn.ghost { background:#f6f6f6; }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }

    .textarea {
      width: 100%; height: 140px; padding: 8px; border: 1px solid #ccc; border-radius: 6px;
      resize: vertical; font: 13px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .day-nav { display:flex; align-items:center; gap:8px; margin: 8px 0; flex-wrap: wrap; }
    .day-nav .btn { padding: 4px 8px; }
    .day-nav select { padding: 4px 8px; }

    .saved-toast {
      font-size: 12px; color: #065f46; background:#ecfdf5; border:1px solid #a7f3d0;
      padding: 4px 8px; border-radius: 6px; display:none; margin-left:auto;
    }
    .saved-toast.show { display:block; }

    /* Food list */
    .food-row { display:flex; align-items:center; gap:8px; margin:6px 0; }
    .food-row input[type="checkbox"] { transform: translateY(1px); }
    .food-row .food-text { flex: 1; font-size: 13px; }
    .food-add { display:flex; gap:8px; margin-bottom:8px; }
    .food-add input { flex:1; }
    .leaflet-popup-content {
  width: 560px !important;  /* Adjust to match maxWidth - padding */
}

#top-bar {
  position: fixed;
  top: 10px;
  right: 10px;
  background: rgba(255,255,255,0.95);
  border: 1px solid #ccc;
  padding: 8px 12px;
  border-radius: 8px;
  z-index: 1000;
  display: flex;
  gap: 8px;
  align-items: center;
  font-size: 13px;
}
#top-bar .btn {
  padding: 4px 8px;
  font-size: 13px;
  cursor: pointer;
}
  </style>
</head>
<body>
  <div id="map"></div>

<div id="top-bar">
  <div id="migration-status" style="position:fixed; top:60px; right:10px; background:#fff; border:1px solid #ccc; padding:6px 10px; border-radius:6px; font-size:13px; z-index:1000; max-height:200px; overflow-y:auto; display:none;"></div>
 <button id="sign-in-btn" class="btn" onclick="firebaseSignIn()">Sign in with Google</button>
  <button id="sign-out-btn" class="btn" onclick="firebaseSignOut()" style="display:none;">Sign out</button>
  <span id="user-info"></span>
  <button id="migrate-btn" class="btn ghost" style="display:none;">Migrate Data to Firebase</button>
</div>

<div id="migration-status" style="
  display:none;
  position:fixed;
  bottom:10px;
  right:10px;
  background:#fff;
  border:1px solid #ccc;
  padding:10px;
  max-width:300px;
  font-size:13px;
  line-height:1.4;
  z-index:1001;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  border-radius:8px;
  overflow-y:auto;
  max-height:50vh;
"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

     
    <!-- Firebase SDKs -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
  import {
    getAuth,
    GoogleAuthProvider,
    signInWithPopup,
    signOut,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";
  import {
    getFirestore,
    doc,
    setDoc,
    getDoc,
    collection,
    getDocs
  } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCAY-izVSAjouJjL960zS8xs84jaOZQBIo",
    authDomain: "kieranholidaymap.firebaseapp.com",
    projectId: "kieranholidaymap",
    storageBucket: "kieranholidaymap.firebasestorage.app",
    messagingSenderId: "733529027142",
    appId: "1:733529027142:web:f1af423b12491a937dd047"
  };

  // Init Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const provider = new GoogleAuthProvider();

  window.firebaseAuth = auth;
  window.firebaseProvider = provider;
  window.firebaseDB = db;
  window.setDoc = setDoc;
window.doc = doc;
window.collection = collection;
window.getDocs = getDocs;

  // Expose sign-in/out functions
  window.firebaseSignIn = () => signInWithPopup(auth, provider);
  window.firebaseSignOut = () => signOut(auth);

  // === SIGN-IN STATE HANDLER ===
  onAuthStateChanged(auth, (user) => {
    const signInBtn = document.getElementById("sign-in-btn");
    const signOutBtn = document.getElementById("sign-out-btn");
    const userInfo = document.getElementById("user-info");
    const migrateBtn = document.getElementById("migrate-btn");

    if (user) {
      signInBtn.style.display = "none";
      signOutBtn.style.display = "inline-block";
      userInfo.textContent = `Signed in as: ${user.displayName}`;

      if (user.email === "kcco1996@gmail.com") {
        migrateBtn.style.display = "inline-block";
      } else {
        migrateBtn.style.display = "none";
      }

      // ✅ Load Firebase trip plans
      (async () => {
        const plansSnapshot = await getDocs(collection(db, "users", user.uid, "plans"));
        plansSnapshot.forEach(docSnap => {
          const plan = docSnap.data()?.data;
          const name = docSnap.data()?.name;
          if (plan && name) {
            localStorage.setItem(`tripPlan:${name}`, JSON.stringify(plan));
            console.log(`✅ Loaded ${name} from Firebase`);
          }
        });

        // ✅ Now render the map
        renderMap();
      })();

    } else {
      // Not signed in
      signInBtn.style.display = "inline-block";
      signOutBtn.style.display = "none";
      userInfo.textContent = "";
      migrateBtn.style.display = "none";

      // Render map anyway (fallback to localStorage)
      renderMap();
    }
  });
</script>

  <script>
    // ---------- Storage helpers ----------
    function storageKey(name){ return `tripPlan:${name}`; }
   function loadPlan(name){
  const raw = localStorage.getItem(storageKey(name));
  const base = {
    days: 1,
    activities: {1:""},
    notes: "",
    hotel: { name:"", currency:"GBP", nightly:"", nights: 1 },
    food: {}   // { [day]: {breakfast:{...}, lunch:{...}, dinner:{...}} }
  };

  let plan;
  try { plan = raw ? JSON.parse(raw) : base; }
  catch { plan = base; }

  // defaults
  if (!plan.activities) plan.activities = {1:""};
  if (typeof plan.days !== "number" || plan.days < 1) plan.days = 1;
  if (typeof plan.notes !== "string") plan.notes = "";
  if (!plan.hotel) {
    plan.hotel = { name:"", currency:"GBP", nightly:"", nights: Math.max(1,(plan.days|0)-1||1) };
  } else {
    if (!("name" in plan.hotel)) plan.hotel.name = "";
    if (!("currency" in plan.hotel)) plan.hotel.currency = "GBP";
    if (!("nightly" in plan.hotel)) plan.hotel.nightly = "";
    if (!("nights" in plan.hotel)) plan.hotel.nights = Math.max(1,(plan.days|0)-1||1);
  }

  // migrate very old single-day format: plan.foodDiary -> plan.food[1]
  if (plan.foodDiary && !plan.food) {
    plan.food = { 1: {
      breakfast: {
        dish: plan.foodDiary?.breakfast?.dish || "",
        hot:  plan.foodDiary?.breakfast?.hot  || "",
        cold: plan.foodDiary?.breakfast?.cold || "",
        description: plan.foodDiary?.breakfast?.description || ""
      },
      lunch: {
        dish: plan.foodDiary?.lunch?.dish || "",
        hot:  plan.foodDiary?.lunch?.hot  || "",
        cold: plan.foodDiary?.lunch?.cold || "",
        description: plan.foodDiary?.lunch?.description || ""
      },
      dinner: {
        starter: plan.foodDiary?.dinner?.starter || "",
        main:    plan.foodDiary?.dinner?.main    || "",
        dessert: plan.foodDiary?.dinner?.dessert || "",
        alcoholic: plan.foodDiary?.dinner?.alcoholic || "",
        cold: plan.foodDiary?.dinner?.cold || "",
        description: plan.foodDiary?.dinner?.description || ""
      }
    }};
    delete plan.foodDiary;
  }

  if (!plan.food || typeof plan.food !== "object" || Array.isArray(plan.food)) plan.food = {};

  // ensure structure for all days
  for (let i=1; i<=plan.days; i++){
    if (!plan.food[i]) {
      plan.food[i] = {
        breakfast: { dish:"", hot:"", cold:"", description:"" },
        lunch:     { dish:"", hot:"", cold:"", description:"" },
        dinner:    { starter:"", main:"", dessert:"", alcoholic:"", cold:"", description:"" }
      };
    }
  }

  return plan;

    }
    function savePlan(name, data){
      localStorage.setItem(storageKey(name), JSON.stringify(data));
    }

    // Small helper for custom destination icons (e.g. flags, city pics)
    function destinationIcon(url) {
      return L.divIcon({
        html: `<img src="${url}" alt="">`,
        className: 'destination-icon',
        iconSize: [null],
        iconAnchor: [20, 20],
        popupAnchor: [0, -18]
      });
    }

    function buildPopup(d) {
      const plan = loadPlan(d.name);
      const days = Math.max(1, Number(plan.days || 1));
      const nightsDefault = Math.max(1, Number(plan.hotel?.nights ?? Math.max(1, days - 1)));

      // Build options for day selector
      const dayOptions = Array.from({length: days}, (_,i)=>`<option value="${i+1}">Day ${i+1}</option>`).join("");

      // Currencies
      const currencies = ["GBP","EUR","USD","CAD","AUD","NZD","JPY","CNY"];
      const currencyOptions = currencies.map(c => `<option value="${c}" ${plan.hotel.currency===c?"selected":""}>${c}</option>`).join("");

      return `
        
        <div class="popup" data-dest="${encodeURIComponent(d.name)}">
          <div class="header">
            ${d.destination ? `<img src="${d.destination}" alt="${d.name} icon" />` : ""}
            <div class="title">
              <h3 style="margin:0 0 4px;">${d.name}</h3>
              ${d.note ? `<p style="margin:0 0 4px;">${d.note}</p>` : ""}
              <p style="margin:6px 0 0;">
                <a href="https://maps.google.com/?q=${d.lat},${d.lng}" target="_blank" rel="noopener">Open in Google Maps</a>
              </p>
            </div>
          </div>

          <div class="tabs">
            <button class="tab-btn active" data-tab="tab-days">Days</button>
            <button class="tab-btn" data-tab="tab-daily">Daily Plan</button>
            <button class="tab-btn" data-tab="tab-stay">Stay & Budget</button>
            <button class="tab-btn" data-tab="tab-food">Food</button>
            <button class="tab-btn" data-tab="tab-notes">Notes</button>
            <span class="saved-toast" aria-live="polite">Saved</span>
          </div>

          <!-- Days tab -->
          <div id="tab-days" class="tab-panel active">
            <div class="row">
              <label for="days-input">Number of days:</label>
              <input id="days-input" type="number" min="1" step="1" value="${days}">
              <button class="btn primary" id="apply-days">Apply</button>
            </div>
            <p class="hint">Set how long you’ll stay. This also influences default nights for hotel total (editable).</p>
          </div>

          <!-- Daily Plan tab -->
          <div id="tab-daily" class="tab-panel">
            <div class="day-nav">
              <button class="btn ghost" id="prev-day" title="Previous day">&#9664;</button>
              <label for="day-select" style="min-width:auto;">Go to:</label>
              <select id="day-select">${dayOptions}</select>
              <button class="btn ghost" id="next-day" title="Next day">&#9654;</button>
            </div>
            <textarea id="day-activities" class="textarea" placeholder="Activities for this day (times, places, tickets, restaurants, notes)..."></textarea>
            <div class="save-bar">
              <button class="btn primary" id="save-day">Save Day</button>
              <button class="btn" id="clear-day">Clear Day</button>
            </div>
          </div>

          <!-- Stay & Budget tab -->
          <div id="tab-stay" class="tab-panel">
            <div class="row">
              <label for="hotel-name">Hotel name (optional):</label>
              <input id="hotel-name" type="text" value="${(plan.hotel.name||"").replace(/"/g,'&quot;')}" placeholder="e.g., Hotel Central">
            </div>
            <div class="row">
              <label for="currency">Currency:</label>
              <select id="currency">${currencyOptions}</select>
            </div>
            <div class="row">
              <label for="nightly">Avg price per night:</label>
              <input id="nightly" type="number" min="0" step="1" value="${plan.hotel.nightly||""}">
            </div>
            <div class="row">
              <label for="nights">Nights:</label>
              <input id="nights" type="number" min="1" step="1" value="${nightsDefault}">
            </div>
            <div class="row">
              <label>Total (auto):</label>
              <div id="hotel-total" aria-live="polite" style="font-weight:600;">—</div>
            </div>
            <div class="save-bar">
              <button class="btn primary" id="save-hotel">Save Stay</button>
              <button class="btn" id="clear-hotel">Clear</button>
            </div>
            <p class="hint">Tip: Nights default to days − 1. Adjust if your arrival/departure times differ.</p>
          </div>

        <!-- Food tab -->
<!-- Food tab -->
<div id="tab-food" class="tab-panel">
  <div class="day-nav">
    <label for="food-day-select">Day:</label>
    <select id="food-day-select"></select>
  </div>

  <div class="tabs food-subtabs">
    <button class="tab-btn active" data-subtab="tab-breakfast">Breakfast</button>
    <button class="tab-btn" data-subtab="tab-lunch">Lunch</button>
    <button class="tab-btn" data-subtab="tab-dinner">Dinner</button>
  </div>

<div id="tab-breakfast" class="tab-panel active">
  <div class="row">
    <label>Dish:</label>
    <input id="breakfast-dish" type="text">
    <input id="breakfast-dish-desc" type="text" placeholder="Description">
  </div>
  <div class="row">
    <label>Hot drink:</label>
    <input id="breakfast-hot" type="text">
    <input id="breakfast-hot-desc" type="text" placeholder="Description">
  </div>
  <div class="row">
    <label>Cold drink:</label>
    <input id="breakfast-cold" type="text">
    <input id="breakfast-cold-desc" type="text" placeholder="Description">
  </div>
</div>


 <div id="tab-lunch" class="tab-panel">
  <div class="row">
    <label>Dish:</label>
    <input id="lunch-dish" type="text">
    <input id="lunch-dish-desc" type="text" placeholder="Description">
  </div>
  <div class="row">
    <label>Hot drink:</label>
    <input id="lunch-hot" type="text">
    <input id="lunch-hot-desc" type="text" placeholder="Description">
  </div>
  <div class="row">
    <label>Cold drink:</label>
    <input id="lunch-cold" type="text">
    <input id="lunch-cold-desc" type="text" placeholder="Description">
  </div>
</div>

 <div id="tab-dinner" class="tab-panel">
  <div class="row">
    <label>Starter:</label>
    <input id="dinner-starter" type="text">
    <input id="dinner-starter-desc" type="text" placeholder="Description">
  </div>
  <div class="row">
    <label>Main course:</label>
    <input id="dinner-main" type="text">
    <input id="dinner-main-desc" type="text" placeholder="Description">
  </div>
  <div class="row">
    <label>Dessert:</label>
    <input id="dinner-dessert" type="text">
    <input id="dinner-dessert-desc" type="text" placeholder="Description">
  </div>
  <div class="row">
    <label>Alcoholic drink:</label>
    <input id="dinner-alcohol" type="text">
    <input id="dinner-alcohol-desc" type="text" placeholder="Description">
  </div>
  <div class="row">
    <label>Cold drink:</label>
    <input id="dinner-cold" type="text">
    <input id="dinner-cold-desc" type="text" placeholder="Description">
  </div>
</div>

  <div class="save-bar">
    <button class="btn primary" id="save-food">Save Food Diary</button>
    <button class="btn" id="clear-food">Clear</button>
  </div>

  <p class="hint">Food diary is saved per destination and includes breakfast, lunch, and dinner entries per day.</p>
</div>;

 <!-- Notes tab -->
        <div id="tab-notes" class="tab-panel">
          <textarea id="notes-text" class="textarea" placeholder="Anything else to remember (tickets, packing, misc)"></textarea>
          <div class="save-bar">
            <button class="btn primary" id="save-notes">Save Notes</button>
            <button class="btn" id="clear-notes">Clear</button>
          </div>
        </div>
      </div>`;

    }

    // After the popup’s HTML is placed in the DOM, wire up its logic
    function initPopupHandlers(container, d){
      const name = d.name;
      const toast = container.querySelector('.saved-toast');
      const plan = loadPlan(name);

      // Tabs
      // Main tabs (only buttons with data-tab — top level only)
const mainTabBtns = container.querySelectorAll('.tab-btn[data-tab]');
mainTabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    mainTabBtns.forEach(b=>b.classList.remove('active'));
    // Only top-level tab panels
    container.querySelectorAll(':scope > .tab-panel').forEach(p=>p.classList.remove('active'));
    btn.classList.add('active');
    const panel = container.querySelector('#'+btn.dataset.tab);
    if (panel) panel.classList.add('active');
  });
});



window.renderMap = renderMap;

      // DAYS TAB
      const daysInput = container.querySelector('#days-input');
      const applyDaysBtn = container.querySelector('#apply-days');
      const rebuildDaySelector = ()=>{
        const daySelect = container.querySelector('#day-select');
        if (!daySelect) return;
        const newDays = Math.max(1, Number(daysInput.value||1));
        // Expand/trim activities
        for (let i=1; i<=newDays; i++){
          if (!(i in plan.activities)) plan.activities[i] = "";
        }
        Object.keys(plan.activities).map(k=>+k).filter(k=>k>newDays).forEach(k=>delete plan.activities[k]);
        // Rebuild
        daySelect.innerHTML = Array.from({length: newDays}, (_,i)=>`<option value="${i+1}">Day ${i+1}</option>`).join("");
        // Update default nights if user hasn’t customized
        const nightsEl = container.querySelector('#nights');
        if (nightsEl && (!plan.hotel.nights || plan.hotel.nights === Math.max(1, plan.days - 1))) {
          nightsEl.value = Math.max(1, newDays - 1);
        }
      };

      applyDaysBtn.addEventListener('click', ()=>{
        plan.days = Math.max(1, Number(daysInput.value||1));
        rebuildDaySelector();
        savePlan(name, plan);
        showSaved(toast);
      });

      // DAILY PLAN TAB
      const daySelect = container.querySelector('#day-select');
      const prevBtn = container.querySelector('#prev-day');
      const nextBtn = container.querySelector('#next-day');
      const dayArea = container.querySelector('#day-activities');
      const saveDayBtn = container.querySelector('#save-day');
      const clearDayBtn = container.querySelector('#clear-day');

      const loadDayText = ()=>{
        const day = Number(daySelect?.value||1);
        dayArea.value = plan.activities[day] ?? "";
      };
      const saveDayText = ()=>{
        const day = Number(daySelect?.value||1);
        plan.activities[day] = dayArea.value;
        savePlan(name, plan);
        showSaved(toast);
      };

      if (daySelect){
        daySelect.addEventListener('change', ()=>{ saveDayText(); loadDayText(); });
        prevBtn.addEventListener('click', ()=>{
          const v = Number(daySelect.value||1);
          if (v>1){ saveDayText(); daySelect.value = String(v-1); loadDayText(); }
        });
        nextBtn.addEventListener('click', ()=>{
          const v = Number(daySelect.value||1);
          const max = Math.max(1, Number(daysInput.value||plan.days||1));
          if (v<max){ saveDayText(); daySelect.value = String(v+1); loadDayText(); }
        });
      }
      saveDayBtn?.addEventListener('click', saveDayText);
      clearDayBtn?.addEventListener('click', ()=>{ dayArea.value = ""; saveDayText(); });

      // STAY & BUDGET TAB
      const hotelName = container.querySelector('#hotel-name');
      const currency = container.querySelector('#currency');
      const nightly = container.querySelector('#nightly');
      const nights = container.querySelector('#nights');
      const total = container.querySelector('#hotel-total');
      const saveHotelBtn = container.querySelector('#save-hotel');
      const clearHotelBtn = container.querySelector('#clear-hotel');

      // Seed values
      if (hotelName) hotelName.value = plan.hotel.name || "";
      if (currency) currency.value = plan.hotel.currency || "GBP";
      if (nightly) nightly.value = plan.hotel.nightly || "";
      if (nights) nights.value = plan.hotel.nights || Math.max(1, (plan.days|0)-1 || 1);

      const renderTotal = ()=>{
        const n = Number(nightly?.value||0);
        const k = Math.max(1, Number(nights?.value||1));
        const curr = currency?.value || "GBP";
        if (n > 0 && k > 0) {
          total.textContent = `${curr} ${(n * k).toLocaleString(undefined,{maximumFractionDigits:0})}`;
        } else {
          total.textContent = "—";
        }
      };
      nightly?.addEventListener('input', renderTotal);
      nights?.addEventListener('input', renderTotal);
      currency?.addEventListener('change', renderTotal);
      renderTotal();

      const saveHotel = ()=>{
        plan.hotel.name = hotelName?.value || "";
        plan.hotel.currency = currency?.value || "GBP";
        plan.hotel.nightly = nightly?.value || "";
        plan.hotel.nights = Math.max(1, Number(nights?.value||1));
        savePlan(name, plan);
        showSaved(toast);
      };
      saveHotelBtn?.addEventListener('click', saveHotel);
      clearHotelBtn?.addEventListener('click', ()=>{
        if (hotelName) hotelName.value = "";
        if (currency) currency.value = "GBP";
        if (nightly) nightly.value = "";
        if (nights) nights.value = Math.max(1, (plan.days|0)-1 || 1);
        saveHotel();
        renderTotal();
      });


      // FOOD TAB
// === FOOD TAB (per day + subtabs) ===
const foodDaySelect = container.querySelector('#food-day-select');
const saveFoodBtn   = container.querySelector('#save-food');
const clearFoodBtn  = container.querySelector('#clear-food');

// Build day options
if (foodDaySelect) {
  foodDaySelect.innerHTML = Array.from({length: plan.days}, (_,i)=>`<option value="${i+1}">Day ${i+1}</option>`).join('');
  foodDaySelect.value = "1";
}

function ensureFoodDay(day){
  if (!plan.food[day]) {
    plan.food[day] = {
      breakfast: { dish:"", hot:"", cold:"", description:"" },
      lunch:     { dish:"", hot:"", cold:"", description:"" },
      dinner:    { starter:"", main:"", dessert:"", alcoholic:"", cold:"", description:"" }
    };
  }
}

const setVal = (sel, v)=>{ const el = container.querySelector(sel); if (el) el.value = v || ""; };
const getVal = (sel)=> (container.querySelector(sel)?.value ?? "");

// Load inputs for a given day
function loadFoodForDay(day){
  ensureFoodDay(day);
  const f = plan.food[day];

  // breakfast
  setVal('#breakfast-dish', f.breakfast.dish);
  setVal('#breakfast-dish-desc', f.breakfast.description);
  setVal('#breakfast-hot', f.breakfast.hot);
  setVal('#breakfast-hot-desc', f.breakfast.hotDescription);
  setVal('#breakfast-cold', f.breakfast.cold);
  setVal('#breakfast-cold-desc', f.breakfast.coldDescription);

  // lunch
  setVal('#lunch-dish', f.lunch.dish);
  setVal('#lunch-dish-desc', f.lunch.description);
  setVal('#lunch-hot', f.lunch.hot);
  setVal('#lunch-hot-desc', f.lunch.hotDescription);
  setVal('#lunch-cold', f.lunch.cold);
  setVal('#lunch-cold-desc', f.lunch.coldDescription);

  // dinner
  setVal('#dinner-starter', f.dinner.starter);
  setVal('#dinner-starter-desc', f.dinner.starterDescription);
  setVal('#dinner-main', f.dinner.main);
  setVal('#dinner-main-desc', f.dinner.mainDescription);
  setVal('#dinner-dessert', f.dinner.dessert);
  setVal('#dinner-dessert-desc', f.dinner.dessertDescription);
  setVal('#dinner-alcohol', f.dinner.alcoholic);
  setVal('#dinner-alcohol-desc', f.dinner.alcoholDescription);
  setVal('#dinner-cold', f.dinner.cold);
  setVal('#dinner-cold-desc', f.dinner.coldDescription);
}

// Read inputs and save into plan for a given day
function saveFoodForDay(day){
  ensureFoodDay(day);
  plan.food[day] = {
    breakfast: {
      dish: getVal('#breakfast-dish'),
      description: getVal('#breakfast-dish-desc'),
      hot: getVal('#breakfast-hot'),
      hotDescription: getVal('#breakfast-hot-desc'),
      cold: getVal('#breakfast-cold'),
      coldDescription: getVal('#breakfast-cold-desc')
    },
    lunch: {
      dish: getVal('#lunch-dish'),
      description: getVal('#lunch-dish-desc'),
      hot: getVal('#lunch-hot'),
      hotDescription: getVal('#lunch-hot-desc'),
      cold: getVal('#lunch-cold'),
      coldDescription: getVal('#lunch-cold-desc')
    },
    dinner: {
      starter: getVal('#dinner-starter'),
      starterDescription: getVal('#dinner-starter-desc'),
      main: getVal('#dinner-main'),
      mainDescription: getVal('#dinner-main-desc'),
      dessert: getVal('#dinner-dessert'),
      dessertDescription: getVal('#dinner-dessert-desc'),
      alcoholic: getVal('#dinner-alcohol'),
      alcoholDescription: getVal('#dinner-alcohol-desc'),
      cold: getVal('#dinner-cold'),
      coldDescription: getVal('#dinner-cold-desc'),
      description: getVal('#dinner-desc')  // optional overall notes
    }
  };
}

let currentFoodDay = Number(foodDaySelect?.value || 1);
loadFoodForDay(currentFoodDay);

// Switch days (auto-save previous day)
foodDaySelect?.addEventListener('change', ()=>{
  saveFoodForDay(currentFoodDay);
  savePlan(name, plan);
  currentFoodDay = Number(foodDaySelect.value || 1);
  loadFoodForDay(currentFoodDay);
  showSaved(toast);
});

// Save/Clear buttons
saveFoodBtn?.addEventListener('click', ()=>{
  saveFoodForDay(currentFoodDay);
  savePlan(name, plan);
  showSaved(toast);
});

clearFoodBtn?.addEventListener('click', ()=>{
  // clear inputs on screen
  ['#breakfast-dish','#breakfast-hot','#breakfast-cold','#breakfast-desc',
   '#lunch-dish','#lunch-hot','#lunch-cold','#lunch-desc',
   '#dinner-starter','#dinner-main','#dinner-dessert','#dinner-alcohol','#dinner-cold','#dinner-desc'
  ].forEach(sel=> setVal(sel,""));
  // clear in plan for this day
  plan.food[currentFoodDay] = {
    breakfast: { dish:"", hot:"", cold:"", description:"" },
    lunch:     { dish:"", hot:"", cold:"", description:"" },
    dinner:    { starter:"", main:"", dessert:"", alcoholic:"", cold:"", description:"" }
  };
  savePlan(name, plan);
  showSaved(toast);
});

// Food subtabs (Breakfast/Lunch/Dinner)
const subButtons = container.querySelectorAll('.food-subtabs .tab-btn');
function activateSubtab(id){
  subButtons.forEach(b=>b.classList.remove('active'));
  container.querySelectorAll('#tab-breakfast,#tab-lunch,#tab-dinner').forEach(p=>p.classList.remove('active'));
  container.querySelector(`.food-subtabs .tab-btn[data-subtab="${id}"]`)?.classList.add('active');
  container.querySelector('#'+id)?.classList.add('active');
}
subButtons.forEach(btn=>{
  btn.addEventListener('click', ()=> activateSubtab(btn.dataset.subtab));
});


      // NOTES TAB
      const notesArea = container.querySelector('#notes-text');
      notesArea.value = plan.notes || "";
      const saveNotesBtn = container.querySelector('#save-notes');
      const clearNotesBtn = container.querySelector('#clear-notes');
      saveNotesBtn.addEventListener('click', ()=>{
        plan.notes = notesArea.value;
        savePlan(name, plan);
        showSaved(toast);
      });
      clearNotesBtn.addEventListener('click', ()=>{
        notesArea.value = "";
        plan.notes = "";
        savePlan(name, plan);
        showSaved(toast);
      });

      // Initialise daily plan UI
      daysInput.value = Math.max(1, Number(plan.days||1));
      // Build selector & load current day content
      (function initDaily(){
        const daySelect = container.querySelector('#day-select');
        if (!daySelect) return;
        daySelect.innerHTML = Array.from({length: plan.days}, (_,i)=>`<option value="${i+1}">Day ${i+1}</option>`).join("");
        daySelect.value = "1";
        dayArea.value = plan.activities[1] ?? "";
      })();

      // Auto-save on popup close
      const popup = container.closest('.leaflet-popup');
      if (popup){
        const onClose = ()=>{
          // Save current pieces
          plan.days = Math.max(1, Number(daysInput.value||1));
          plan.notes = notesArea.value;
          const currentDay = Number((container.querySelector('#day-select')?.value)||1);
          plan.activities[currentDay] = dayArea.value;

          // Hotel panel save (non-destructive)
          plan.hotel.name = container.querySelector('#hotel-name')?.value || plan.hotel.name || "";
          plan.hotel.currency = container.querySelector('#currency')?.value || plan.hotel.currency || "GBP";
          plan.hotel.nightly = container.querySelector('#nightly')?.value || plan.hotel.nightly || "";
          plan.hotel.nights = Math.max(1, Number(container.querySelector('#nights')?.value || plan.hotel.nights || 1));

          savePlan(name, plan);
          popup.removeEventListener('transitionend', onClose);
        };
        popup.addEventListener('transitionend', onClose);
      }
    }

    function showSaved(toastEl){
      if (!toastEl) return;
      toastEl.classList.add('show');
      setTimeout(()=>toastEl.classList.remove('show'), 1200);
    }

    // === HOLIDAY DESTINATIONS ===
    const destinations = [

    // North America
           {
        name: "Seattle",
        lat: 47.60772453397215,  lng: -122.33571831316796,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Vancouver",
        lat: 49.28239845936347, lng: -123.1201280732361,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Banff",
        lat: 51.17832458370294, lng: -115.5707963532298,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Detroit",
        lat: 42.329879544353226, lng: -83.0409047870654,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Toronto",
        lat:  43.652627129818654, lng: -79.38432555629761,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Ottawa",
        lat: 45.41997247826557, lng: -75.70000171763027,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Montreal",
        lat: 45.503463342454616, lng: -73.56769621488876,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Quebec City",
        lat: 46.812554109739246, lng: -71.2081315885433,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
        {
        name: "New York City",
        lat: 40.71209411855515, lng: -74.00500529400429,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Philadelphia",
        lat: 39.95362138471616, lng: -75.15725298609271,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Boston",
        lat: 42.355756353550504, lng: -71.05980501991988,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Washington DC",
        lat: 38.90950627319311, lng: -77.0378603298129,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Charlotte",
        lat: 35.22068845703077, lng: -80.84207585899921,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Kentucky Bourbon Trail",
        lat: 36.96615901727974, lng: -86.18277184438787,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Chicago",
        lat: 41.88268842658458, lng: -87.62751922198979,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Indianapolis",
        lat: 39.7689786349564, lng: -86.15311289232605,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
        {
        name: "Cleveland",
        lat: 41.50273521152955, lng: -81.68986031536389,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Kansas City",
        lat: 39.10034294911827, lng: -94.5833309693297,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Denver",
        lat: 39.7403722248545, lng: -104.97767259664374,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Moab",
        lat: 38.57327876611761, lng: -109.55074386985126,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Yellowstone National Park",
        lat: 44.611411823368435, lng: -110.514530780498,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Miami",
        lat: 25.76323961340018, lng: -80.1922635683231,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Savannah",
        lat: 32.080776482381886, lng: -81.09070428371469,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Charleston",
        lat: 32.783630768755735, lng: -79.93041210581677,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
            {
        name: "Atlanta",
        lat: 33.74980983050412, lng: -84.3877520670381,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
            {
        name: "New Orleans",
        lat: 29.950974551233713, lng: -90.07527395509003,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
            {
        name: "Memphis",
        lat: 35.14814012845415, lng: -90.0504868932041,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
            {
        name: "Nashville",
        lat: 36.162542545391226, lng: -86.7822524630937,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
            {
        name: "Huntsville",
        lat: 34.73015580981167, lng: -86.58397780143977,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Houston",
        lat: 29.76656834960227, lng: -95.36236094159233,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Austin",
        lat: 30.271106994370317, lng: -97.73504184817182,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Santa Fe",
        lat: 35.68959519613997, lng:  -105.93721216032161,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Route 66",
        lat: 35.19212083604028, lng: -114.04847373827002,     
        destination: "assets/black-dot.png",  
        note: "-"
      },
       {
        name: "Phoenix",
        lat: 33.44518313947133, lng: -112.07786658699041,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
       {
        name: "Sedona",
        lat: 34.86371195123784, lng: -111.81438583102138,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
       {
        name: "Grand Canyon",
        lat: 36.100802410513744, lng: -112.11205548994302,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
       {
        name: "Las Vegas",
        lat: 36.17149945007827, lng: -115.13872482571836,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
        {
        name: "Los Angeles",
        lat: 34.05465650605094, lng: -118.2561380681273,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
        {
        name: "San Francisco",
        lat: 37.77784484651388, lng: -122.41282705873314,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Guadalajara",
        lat: 20.677010987331542, lng: -103.34752670709736,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Mexico City",
        lat: 19.432544560239055, lng: -99.13096556640932,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Oaxaca",
        lat: 17.07278435125949, lng: -96.72634456484178,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Merida",
        lat: 20.967716148485437, lng: -89.59273287275839,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Havana",
        lat: 23.13459246458203, lng: -82.35791906899723,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Vinales",
        lat: 22.618811297850826, lng: -83.70665053329138,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Kingston",
        lat: 18.0183056544133,  lng: -76.8089772023489,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
           {
        name: "Ocho Rios",
        lat: 18.4073695583668,  lng: -77.10310726492314,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Negril",
        lat: 18.278913566295927, lng:  -78.34370756164991,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Montego Bay",
        lat: 18.471831669696066, lng: -77.92041525946033,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "San Jose",
        lat:  9.928248163622198, lng: -84.09028388072183,  
        destination: "assets/black-dot.png",  
        note: "-"
      },

      // South America
         {
        name: "Bogota",
        lat: 4.711093897883025, lng: -74.0714359026008,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Medellin",
        lat: 6.247629211964346, lng: -75.56438625894688,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Quito",
        lat: -0.2232819603237502, lng: -78.5136979263753,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Santiago",
        lat: -33.45130231352738, lng: -70.6766724657009,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Lima",
        lat: -12.045936019259404, lng:  -77.04475828442126, 
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Cusco",
        lat: -13.531907393993903, lng: -71.96733800414252,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
             {
        name: "Sucre",
        lat: -19.035251140767482, lng: -65.26030793967227,   
        destination: "assets/black-dot.png",  
        note: "-"
      },
             {
        name: "La Paz",
        lat: -16.494290618939463, lng: -68.12111919909478,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Rio de Janeiro",
        lat: -22.9070198031695, lng: -43.17328824523965,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Sao Paulo",
        lat: -23.555503217315778, lng: -46.63535076679225,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Salvador",
        lat: -12.977855380518672, lng: -38.50186684249251,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Manaus",
        lat: -3.119432526904342, lng: -60.022290304328386,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Buenos Aires",
        lat: -34.60096265053558, lng: -58.38427623057528,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Patagonia",
        lat: -50.33429494633946, lng: -72.16542956843975,  
        destination: "assets/black-dot.png",  
        note: "-"
      },

      // Europe
           {
        name: "Reykjavik",
        lat: 64.14709405288546, lng: -21.94067790838177, 
        destination: "assets/black-dot.png",  
        note: "-"
      },
         {
        name: "Copenhagen",
        lat: 55.676854151467786, lng: 12.580432292830622, 
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Stockholm",
        lat: 59.33187532601879, lng: 18.064524018132875,  
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Oslo",
        lat: 59.91386946136484, lng: 10.752263050710615,  
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Tallinn",
        lat: 59.43696134448128, lng: 24.75359472967316,   
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Helsinki",
        lat: 60.169886209818955, lng: 24.938506956243987,  
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Rovaniemi",
        lat: 66.50399462506353, lng: 25.727375199411455,   
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Riga",
        lat: 56.9678169002369, lng: 24.10550715762453,  
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Vilnius",
        lat: 54.68727825033513, lng: 25.278964588963454,   
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Warsaw",
        lat: 52.229837385379945, lng: 21.013155400849673, 
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Krakow",
        lat: 50.06471010338415,  lng: 19.94501598212411,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Berlin",
        lat: 52.52015230261851,  lng: 13.40472495464267,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Dresden",
        lat: 51.050420008439275,  lng: 13.737185466428961,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Nuremburg",
        lat: 49.454344532422105,  lng: 11.074653808733487,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Munich",
        lat: 48.13515007527161,  lng: 11.582113298663685,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Cologne",
        lat: 50.93760687245601,  lng: 6.960286447380035,   
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "The Romantic Road",
        lat: 49.359239026082584,  lng: 10.146048324458654,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "The Black Forest",
        lat: 47.99931012062807,  lng: 7.843104291358877,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Stuttgart",
        lat: 48.77586339862911,  lng: 9.183066700353741,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Amsterdam",
        lat: 52.36769210020186,  lng: 4.90342956807473,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "The Hague",
        lat: 52.0705306104099,  lng: 4.300647577134074,  
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Brussels",
        lat: 50.847811707920954,  lng: 4.356641749053609,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Bruges",
        lat: 51.20842016126747,  lng: 3.225031505055912,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Ypres",
        lat: 50.85774375829256,  lng: 2.8715042484899715,    
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "London",
        lat: 51.50737420589367,  lng: -0.1274675391548623,  
        destination: "assets/black-dot.png",
        note: "-"
      },
           {
        name: "Cambridge",
        lat: 52.195405725848715,  lng: 0.13118782657581468,   
        destination: "assets/uk-flag.png",
        note: "-"
      },
           {
        name: "York",
        lat: 53.96143607420014,  lng: -1.073896473243887,   
        destination: "assets/black-dot.png",
        note: "-"
      },
           {
        name: "Birmingham",
        lat: 52.482522920211096,  lng: -1.8871140472229588,   
        destination: "assets/uk-flag.png",
        note: "-"
      },
          {
        name: "Cornwall",
        lat: 50.26318556354491,  lng: -5.051119976967521,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Cotswolds",
        lat: 51.79066737441077,  lng: -1.959030249663092,   
        destination: "assets/black-dot.png",
        note: "-"
      },
            {
        name: "Liverpool",
        lat: 53.3995552129288,  lng: -2.9919151290257204,   
        destination: "assets/uk-flag.png",
        note: "-"
      },

           {
        name: "Manchester",
        lat: 53.4807874264068,  lng: -2.242631762475635,    
        destination: "assets/uk-flag.png",
        note: "-"
      },

         {
        name: "Newcastle upon Tyne",
        lat: 54.97816889476448,  lng: -1.6192130711390966,    
        destination: "assets/uk-flag.png",
        note: "-"
      },
         {
        name: "Norwich",
        lat: 52.62852569309048,  lng: 1.2920834867214679,   
        destination: "assets/uk-flag.png",
        note: "-"
      }, 
          {
        name: "Sheffield",
        lat: 53.38118101891275,  lng: -1.4707796216441675,    
        destination: "assets/uk-flag.png",
        note: "-"
      }, 
      {
        name: "Bath",
        lat: 51.38201048972575,  lng: -2.3598822371271715,   
        destination: "assets/uk-flag.png",
        note: "-"
      },
       {
        name: "Nottingham",
        lat: 52.95433379037081,  lng: -1.1540116456294196,    
        destination: "assets/uk-flag.png",
        note: "-"
      },
        {
        name: "Stratford upon Avon",
        lat: 52.19385188517134,  lng: -1.716165905373178,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Edinburgh",
        lat: 55.95325883585607,  lng: -3.188374500397275,    
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Scottish Highlands",
        lat: 57.27071118684419,  lng: -4.491824424257684,    
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Mayo",
        lat: 53.944509443188004,  lng: -8.950306440377075,   
        destination: "assets/ireland-flag.png",
        note: "-"
      },
          {
        name: "Galway",
        lat: 53.27400852952436,  lng: -9.051249879576808,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Dublin",
        lat: 53.35035230667644,   lng: -6.261570654846846,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Clare",
        lat:  53.01617120231845,  lng: -9.376488034917385,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Kerry",
        lat: 52.140880544924244,  lng: -10.266980672936224,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Cork",
        lat: 51.898777412116885,  lng: -8.475462716333837,    
        destination: "assets/black-dot.png",
        note: "-"
      },
            {
        name: "Normandy",
        lat: 49.02639381371219,   lng: -0.3697326266154875,    
        destination: "assets/black-dot.png",
        note: "-"
      },
            {
        name: "Loire Valley",
        lat: 47.386772141359685,  lng: 0.6890031823450209,     
        destination: "assets/black-dot.png",
        note: "-"
      },
            {
        name: "Champagne",
        lat: 49.25839361472694, lng: 4.031575031000748,    
        destination: "assets/black-dot.png",  
        note: "-"
      },
            {
        name: "Paris",
        lat: 48.85754857065964,  lng: 2.351095450719635,     
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Bordeaux",
        lat: 44.8415303873766,  lng:  -0.5813877132162164,    
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Lyon",
        lat:  45.764531696190446,  lng: 4.835179746610237,   
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Provence",
        lat: 43.53224241465617,  lng: 5.447647729782521,     
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "French Riviera",
        lat: 43.490900611084136,  lng: 6.793765877236518,     
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Zurich",
        lat: 47.37720188312213,  lng: 8.540854776359472,     
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Bern",
        lat: 46.947906876886854,  lng:  7.449008433944463,    
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Lausanne",
        lat: 46.51988531765292,  lng:  6.63178833810393,    
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Geneva",
        lat: 46.20459779299723,  lng: 6.1434692385512,
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Innsbruck",
        lat: 47.26773065798142,  lng: 11.391160498755447,     
        destination: "assets/black-dot.png",    
        note: "-"
      },
      {
        name: "Salzburg",
        lat: 47.80146559489588,  lng: 13.04496781804285,     
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Vienna",
        lat: 48.20820087607286,  lng: 16.372051489142063,     
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Hallstatt",
        lat: 47.56132162182419, lng: 13.647363161751343,     
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Budapest",
        lat: 47.49670043112757,  lng: 19.036921385094285,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Prague",
        lat: 50.07529559169478,  lng: 14.43796598469235,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Bratislava",
        lat: 48.14771028366622,  lng: 17.108819044864113,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Ljubljana",
        lat: 46.05694787715469,  lng: 14.505271244549682,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Zagreb",
        lat: 45.81506100906844,  lng: 15.98182332859979,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Split",
        lat: 43.51470354492875,  lng: 16.443583819893906,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Dubrovnik",
        lat: 42.650679244840276,  lng: 18.094383893378385,     
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Bucharest",
        lat: 44.42651877964872, lng: 26.108711286865084, 
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Transylvania",
        lat: 45.65305831498248, lng: 25.736030432352848, 
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Belgrade",
        lat: 44.81473845896609,  lng: 20.45953718262759,
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Lviv",
        lat: 49.84240270117403, lng: 24.029742732639285,
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Kyiv",
        lat: 50.446102816627544,  lng: 30.522381936032804,
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Odesa",
        lat: 46.48680823524833,  lng: 30.73031732215606,
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Rome",
        lat: 41.89768815086756, lng: 12.476936055158559,
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Bologna",
        lat: 44.49496560820093, lng: 11.340267944322584,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Tuscany",
        lat: 43.772361190082286, lng: 11.239249355989253,   
        destination: "assets/black-dot.png",
        note: "-"
      },
    {
        name: "Naples",
        lat: 40.84894725749906, lng: 14.272991819770132,  
        destination: "assets/italy-flag.png",
        note: "City break base for Amalfi/Pompeii."
      },
      {
        name: "Milan",
        lat: 45.468509121636934, lng: 9.182456487176053,  
        destination: "assets/black-dot.png",
        note: "Fashion & lakes gateway."
      },
        {
        name: "Lake Como",
        lat: 46.010461636720414, lng: 9.258370422860988,  
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Cinque Terre",
        lat: 44.14693730452264, lng: 9.646125336631743,  
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Amalfi Coast",
        lat: 40.63666057445816, lng: 14.60243262282775,   
        destination: "assets/italy-flag.png",
        note: "-"
      },
        {
        name: "Venice",
        lat: 45.44080421549296, lng: 12.317325210367073,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Athens",
        lat: 37.985824191533005, lng: 23.728725630749693,  
        destination: "assets/black-dot.png",  
        note: "-"
      },
          {
        name: "Mykonos",
        lat: 37.4458201103513,  lng: 25.326357225868886,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Santorini",
        lat: 36.416619151961775, lng: 25.432321334668732,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Rhodes",
        lat: 36.43713002447467,  lng: 28.218355279699313,  
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Seville",
        lat: 37.38886748702286, lng: -5.985099678517259,   
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Toledo",
        lat: 39.8636917531435, lng: -4.029775145026025,   
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Madrid",
        lat: 40.415448974473684, lng: -3.701855273322984,  
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Barcelona",
        lat: 41.38825990594541, lng: 2.1638757607500914,
        destination: "assets/black-dot.png",
        note: "Beach + architecture."
      },
         {
        name: "San Sebastian",
        lat: 43.31804706519294, lng: -1.980072603131987,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Valencia",
        lat: 39.4748365711434, lng: -0.37112701705047646,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Granada",
        lat: 37.18244889952489, lng: -3.6024299116716727,
        destination: "assets/black-dot.png",  
        note: "-"
      },
      {
        name: "Lisbon",
        lat: 38.723048843144994, lng: -9.140853723871166,  
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Porto",
        lat: 41.1583050409901, lng: -8.630365712766778,   
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Sintra",
        lat: 38.802329690843884, lng: -9.38164860384695,    
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Algarve",
        lat: 37.0167014704076,  lng: -7.9354679155059715,  
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Madeira",
        lat: 32.65106517114215, lng: -16.89610598550119,  
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Istanbul",
        lat: 41.008831294064244, lng: 28.984703163215887,  
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Cappadocia",
        lat: 38.6485294471911, lng: 34.850133350771664,  
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Saint Petersburg",
        lat: 59.934427728738875, lng: 30.347911942320994,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Moscow",
        lat: 55.75980497991659, lng: 37.613489679534126,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Kazan",
        lat: 55.79158767130585, lng: 49.125752153475034,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Nizhniy Novgorod",
        lat: 56.33863023023021, lng: 44.02407394794639,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Vladivostok",
        lat: 43.10766291186338, lng: 131.75664496518553,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Novosibirsk",
        lat: 54.9914425497611, lng: 82.87034985503675,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Samara",
        lat: 53.22063967045973, lng: 50.30563600562854,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Yekaterinburg",
        lat: 56.844668410686566, lng: 60.649363398142995,     
        destination: "assets/black-dot.png",
        note: "-"
      },

      // Africa

           {
        name: "Tangier",
        lat: 35.76519622921863, lng: -5.83103937197697,   
        destination: "assets/black-dot.png",
        note: "-"
      },
           {
        name: "Fez",
        lat: 34.02125274081572, lng: -5.0062043083969066,   
        destination: "assets/black-dot.png",
        note: "-"
      },
           {
        name: "Marrakesh",
        lat: 31.625240650856576, lng: -7.98622668742172,   
        destination: "assets/black-dot.png",
        note: "-"
      },
          {
        name: "Rabat",
        lat: 34.00887253019932, lng: -6.853794004072933,   
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Nairobi",
        lat: -1.2927133735799872, lng: 36.82294667348338,   
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Serengeti",
        lat: -1.9315360415877365, lng: 34.713923669409745,   
        destination: "assets/black-dot.png",
        note: "-"
      },

       {
        name: "Zanzibar",
        lat: -6.165611978690259, lng: 39.205606782775384,   
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Addis Ababa",
        lat: 9.021420718978447, lng: 38.75764725727833,   
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Johannesburg",
        lat: -26.205817768123712, lng: 28.033246357057312,   
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Cape Town",
        lat: -33.9222519945119, lng: 18.426083283090602,   
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Cairo",
        lat: 30.04685244060589, lng: 31.236490953674103,    
        destination: "assets/black-dot.png",
        note: "-"
      },
      {
        name: "Luxor",
        lat: 25.687385576610335, lng: 32.6397970280669,    
        destination: "assets/black-dot.png",
        note: "-"
      },  

// Asia 

{
        name: "Tel Aviv",
        lat: 32.08428882890555,  lng: 34.78059411990009,    
        destination: "assets/black-dot.png",
        note: "-"
      },

      {
        name: "Jerusalem",
        lat: 31.776548431123597, lng: 35.22375920797924,     
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Nazareth",
        lat: 32.69962007778769, lng: 35.30378994793834,      
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Bethlehem",
        lat: 31.70546805465603, lng: 35.202443641312925,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Doha",
        lat: 25.292374400028212, lng: 51.53674347744931,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Dubai",
        lat: 25.207730855832907, lng: 55.271777216689955,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Abu Dhabi",
        lat: 24.45884264645748, lng: 54.37884316312715,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Amman",
        lat: 31.963869136227153, lng: 35.91315978587027,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Petra",
        lat: 30.324071582180242, lng: 35.480108064581735,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Wadi Rum",
        lat: 29.572965142387975, lng: 35.421470700401095,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Riyadh",
        lat: 24.715895294828403, lng: 46.67566322133952,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Jeddah",
        lat: 21.53156143617193, lng: 39.16117332713833,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Beijing",
        lat: 39.904708948207066, lng: 116.40629378666631,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Xian",
        lat: 34.26753153354574, lng: 108.95453479024569,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Pyongyang",
        lat: 39.03976450173026, lng: 125.76275374068145,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Hong Kong",
        lat:  22.32159648361065, lng: 114.1727908314567,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Shenzhen",
        lat: 22.542565658160562, lng: 114.06266507893243,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Guilin",
        lat: 25.271175781713136, lng: 110.30209035294487,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Chengdu",
        lat: 30.572395054678324, lng: 104.0674766603587,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Shanghai",
        lat: 31.231548282892074, lng: 121.47375440409512,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Hangzhou",
        lat: 30.273474823912203, lng: 120.15454624495673,     
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Suzhou",
        lat: 31.298654766475444, lng: 120.58309739339623,     
        destination: "assets/black-dot.png",
        note: "-"
      },
        {
        name: "Yangshuo",
        lat: 24.77720779069028, lng: 110.49528760296474,      
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Ulaanbaatar",
        lat: 47.922340586775356, lng: 106.91623272436372,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Hanoi",
        lat: 21.02729979127629, lng: 105.83355947408955,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Ha Long Bay",
        lat: 20.971364767234384, lng:  107.04472913915995,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Hue",
        lat: 16.463400248681836, lng: 107.59028389695361,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Hoi An",
        lat: 15.880126911948263, lng: 108.3260499283607,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Vientiane",
        lat: 17.98009849914131, lng: 102.62848284748861,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Luang Prabang",
        lat: 19.88343247553513, lng: 102.13861060749099,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Manila",
        lat: 14.599518801255039, lng: 120.9853587783262,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Boracay",
        lat: 11.967544811082488, lng: 121.924502332347,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Palawan",
        lat: 9.44180340554734, lng: 118.39350352286588,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Phnom Penh",
        lat: 11.557457618823975, lng: 104.9284773437748,     
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Sihanoukville",
        lat: 10.658582426769515,  lng: 103.26745258802944,     
        destination: "assets/black-dot.png",
        note: "-"
      },
         {
        name: "Siem Reap",
        lat: 13.363402361705312, lng: 103.85664038143845,      
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Bangkok",
        lat: 13.757196289320774, lng: 100.50180904895753,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Chiang Mai",
        lat: 18.789041587241105, lng: 98.98688984278627,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Phuket",
        lat: 7.985784278175289, lng: 98.33112686382262,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Jakarta",
        lat: -6.187357070671649, lng: 106.85413102385716,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Yogyakarta",
        lat: -7.801414654548781, lng: 110.36580328892495,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Borneo",
        lat: -0.25078218449481476, lng: 114.21965753241345,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Bali",
        lat: -8.40778769353757,  lng: 115.18413395274675,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Kuala Lumpur",
        lat: 3.149925859843929, lng: 101.69283219800404,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Singapore",
        lat: 1.2809496197123105, lng: 103.85011777392548,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Taipei",
        lat: 25.034374188812905, lng: 121.56692858749368,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Seoul",
        lat: 37.55395545384301, lng: 126.9936361370215,      
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Gyeongju",
        lat: 35.82195665684188, lng: 129.2650109125429,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Busan",
        lat: 35.164763969341344, lng: 129.05181443860144,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Delhi",
        lat: 28.68555588857057, lng: 77.22848852846143,     
        destination: "assets/black-dot.png",
        note: "-"
      },
           {
        name: "Agra",
        lat: 27.177560663830192, lng: 78.00784831692503,      
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Jaipur",
        lat: 26.914579627509745, lng: 75.79295806709231,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Jodhpur",
        lat: 26.24262492174262, lng: 73.02951022538846,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Mumbai",
        lat: 18.959501056711073, lng: 72.83288671970709,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Varanasi",
        lat: 25.318894877020533, lng: 82.9730837377627,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Chennai",
        lat: 13.085513669421807, lng: 80.27047989785116,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Colombo",
        lat: 6.925926707030244, lng: 79.86204116414342,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Kathmandu",
        lat: 27.71229766152192, lng: 85.32235549565038,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Tokyo",
        lat: 35.68167621444384, lng: 139.7694776560827,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Sapporo",
        lat: 43.06294133982934, lng: 141.35432679202515,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Kanazawa",
        lat: 36.581808011899284, lng: 136.56526033926303,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Hiroshima",
        lat: 34.39953198434529, lng: 132.45103637973926,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Osaka",
        lat: 34.695470570371114, lng: 135.50171588088833,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Nara",
        lat: 34.70280310803936, lng: 135.82606246414989,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Kyoto",
        lat: 35.01239320606751, lng: 135.76739059848708,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Okayama",
        lat: 34.65820269705041, lng: 133.91912330122736,    
        destination: "assets/black-dot.png",
        note: "-"
      },

// Oceania 

 {
        name: "Melbourne",
        lat: -37.804115012656496, lng: 144.95009983596563,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Brisbane",
        lat: -27.471493931577516, lng: 153.01409227438853,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Sydney",
        lat:  -33.87234939702612, lng: 151.20637468765491,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Canberra",
        lat: -35.27830446247856, lng: 149.13083083876302,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Tasmania",
        lat: -41.88770097039727, lng: 146.46066215547248,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Auckland",
        lat: -36.8504369916508, lng: 174.7592070221226,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Rotorua",
        lat:  -38.144253336442446, lng: 176.23598615409264,    
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Queenstown",
        lat: -45.03020847165292, lng: 168.6612610095522,     
        destination: "assets/black-dot.png",
        note: "-"
      },
       {
        name: "Bora Bora",
        lat:  -16.50599688653384, lng: -151.74218231492173,    
        destination: "assets/black-dot.png",
        note: "-"
      },

    ];

        // === MAP SETUP ===
    const map = L.map("map").setView([48.5, 8], 5);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    function renderMap() {
  const layer = L.featureGroup().addTo(map);
  const markers = [];

  for (const d of destinations) {
    const icon = d.destination ? destinationIcon(d.destination) : undefined;
    const marker = L.marker([d.lat, d.lng], icon ? { icon } : undefined);
    marker.bindPopup(buildPopup(d), { maxWidth: 600 });

    marker.on('popupopen', (e) => {
      const el = e.popup.getElement();
      requestAnimationFrame(() => {
        const container = el.querySelector('.popup');
        if (container) initPopupHandlers(container, d);
      });
    });

    layer.addLayer(marker);
    markers.push(marker);
  }

  if (layer.getLayers().length > 0) {
    const bounds = layer.getBounds();
    if (bounds.isValid()) map.fitBounds(bounds.pad(0.2));
  }
}

document.addEventListener("DOMContentLoaded", () => {
  const migrateBtn = document.getElementById("migrate-btn");

  if (migrateBtn) {
    migrateBtn.addEventListener("click", async () => {
      const user = firebaseAuth.currentUser;
      const db = firebaseDB;

      if (!user || !db) return;

      const statusBox = document.getElementById("migration-status");
      statusBox.innerHTML = "";
      statusBox.style.display = "block";

      const keys = Object.keys(localStorage).filter(k => k.startsWith("tripPlan:"));
      if (keys.length === 0) {
        statusBox.innerHTML = "❌ No local plans found.";
        return;
      }

      for (const key of keys) {
        const name = key.replace("tripPlan:", "");
        const data = JSON.parse(localStorage.getItem(key));

        try {
          await setDoc(doc(db, "users", user.uid, "plans", name), { name, data });
          const msg = `✅ Migrated "${name}" to Firebase.`;
          const line = document.createElement("div");
          line.textContent = msg;
          statusBox.appendChild(line);
        } catch (err) {
          const msg = `❌ Failed to migrate "${name}": ${err.message}`;
          const line = document.createElement("div");
          line.textContent = msg;
          statusBox.appendChild(line);
        }
      }
    });
  }
});
  </script>
</body>
</html>